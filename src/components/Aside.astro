---
/**
 * Custom Aside component with styled header and optional collapse
 *
 * Usage:
 * <Aside type="tip">Content here</Aside>
 * <Aside type="note" title="Custom Title">Content here</Aside>
 * <Aside type="caution" collapse>Collapsible content here</Aside>
 */

interface Props {
  type?: 'note' | 'tip' | 'caution' | 'danger' | 'example';
  title?: string;
  collapse?: boolean;
}

const { type = 'note', title, collapse = false } = Astro.props;

const titles: Record<string, string> = {
  note: 'Note',
  tip: 'Tip',
  caution: 'Warning',
  danger: 'Danger',
  example: 'Example',
};

const displayTitle = title || titles[type] || 'Note';

const icons: Record<string, string> = {
  note: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>`,
  tip: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M9 21c0 .5.4 1 1 1h4c.6 0 1-.5 1-1v-1H9v1zm3-19C8.1 2 5 5.1 5 9c0 2.4 1.2 4.5 3 5.7V17c0 .5.4 1 1 1h6c.6 0 1-.5 1-1v-2.3c1.8-1.3 3-3.4 3-5.7 0-3.9-3.1-7-7-7z"/></svg>`,
  caution: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>`,
  danger: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>`,
  example: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/></svg>`,
};
---

{collapse ? (
  <details class={`aside aside--${type}`}>
    <summary>
      <span class="aside-icon" set:html={icons[type]} />
      <span class="aside-title">{displayTitle}</span>
      <svg class="aside-chevron" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </summary>
    <div class="aside-content">
      <slot />
    </div>
  </details>
) : (
  <div class={`aside aside--${type}`}>
    <div class="aside-header">
      <span class="aside-icon" set:html={icons[type]} />
      <span class="aside-title">{displayTitle}</span>
    </div>
    <div class="aside-content">
      <slot />
    </div>
  </div>
)}

<style>
  .aside {
    margin: 1rem 0;
    border-radius: 0.5rem;
    overflow: hidden;
    border: 1px solid transparent;
  }

  /* Type-specific colors */
  .aside--tip {
    --aside-color: #43A047;
    --aside-bg: rgba(67, 160, 71, 0.15);
    --aside-header-bg: rgba(67, 160, 71, 0.25);
    border-color: var(--aside-color);
  }

  .aside--note {
    --aside-color: #43A047;
    --aside-bg: rgba(67, 160, 71, 0.15);
    --aside-header-bg: rgba(67, 160, 71, 0.25);
    border-color: var(--aside-color);
  }

  .aside--caution {
    --aside-color: #FB8C00;
    --aside-bg: rgba(251, 140, 0, 0.15);
    --aside-header-bg: rgba(251, 140, 0, 0.25);
    border-color: var(--aside-color);
  }

  .aside--danger {
    --aside-color: #E53935;
    --aside-bg: rgba(229, 57, 53, 0.15);
    --aside-header-bg: rgba(229, 57, 53, 0.25);
    border-color: var(--aside-color);
  }

  .aside--example {
    --aside-color: #8E24AA;
    --aside-bg: rgba(142, 36, 170, 0.15);
    --aside-header-bg: rgba(142, 36, 170, 0.25);
    border-color: var(--aside-color);
  }

  .aside-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.6rem 1rem;
    background: var(--aside-header-bg);
    color: var(--sl-color-white);
    font-weight: 600;
    font-size: 0.95rem;
  }

  .aside-icon {
    display: flex;
    align-items: center;
    color: var(--aside-color);
  }

  .aside-title {
    flex: 1;
  }

  .aside-content {
    margin-top: 0;
    padding: 0.75rem 1rem;
    background: transparent;
    color: var(--sl-color-gray-2);
    font-size: 0.95rem;
    line-height: 1.6;
  }

  .aside-content :global(p:first-child) {
    margin-top: 0;
  }

  .aside-content :global(p:last-child) {
    margin-bottom: 0;
  }

  /* Collapsible styles */
  details.aside {
    cursor: default;
    padding: 0;
  }

  details.aside > summary {
    cursor: pointer;
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.6rem 1rem;
    background: var(--aside-header-bg);
    color: var(--sl-color-white);
    font-weight: 600;
    font-size: 0.95rem;
  }

  details.aside > summary::-webkit-details-marker,
  details.aside > summary::marker {
    display: none !important;
    content: none !important;
    list-style: none !important;
    font-size: 0 !important;
    width: 0 !important;
    height: 0 !important;
  }

  details.aside > summary {
    list-style-type: none !important;
  }

  details.aside > summary::before {
    display: none !important;
    content: none !important;
  }

  details.aside > summary:focus {
    outline: none;
  }

  .aside-chevron {
    transition: transform 0.2s ease;
    color: var(--sl-color-gray-3);
    margin-left: auto;
  }

  details.aside[open] .aside-chevron {
    transform: rotate(90deg);
  }

  details.aside:not([open]) .aside-content {
    display: none;
  }
</style>
